<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recharger</title>

    <style>
        body{
            margin:0;
            font-family: 'Poppins', Arial, sans-serif;
            background:#f5f7fa;
            color:#000;
        }

        .header{
            background:#000;
            color:#fff;
            padding:14px 16px;
            font-weight:600;
            display:flex;
            align-items:center;
            gap:10px;
        }

        .top-banner{
            width:100%;
            height:240px;
            background:url("/static/images/fed3.jpg") center/cover no-repeat;
            position:relative;
        }

        .balance-overlay{
            position:absolute;
            bottom:0;
            left:0;
            right:0;
            background:#e6e7ea;
            padding:14px 16px;
        }

        .balance-overlay h2{
            margin:0;
            font-size:28px;
            font-weight:700;
        }

        .balance-overlay p{
            margin:4px 0 0;
            font-size:14px;
            color:#555;
        }

        .container{
            padding:18px;
        }

        h3{
            margin:12px 0 6px;
            font-size:18px;
        }

        .info-box{
            background:#000;
            color:#fff;
            padding:12px;
            border-radius:8px;
            text-align:center;
            margin-top:10px;
            font-size:14px;
        }

        .amount-grid{
            display:flex;
            flex-wrap:wrap;
            gap:10px;
            margin-top:14px;
        }

        .amount-btn{
            width:30%;
            padding:12px 0;
            border-radius:20px;
            text-align:center;
            background:#fff;
            border:1px solid #ddd;
            cursor:pointer;
            font-weight:600;
        }

        .amount-btn:hover{
            background:#0b66ff;
            color:#fff;
        }

        .form-row{
            margin-top:14px;
        }

        input, select{
            width:100%;
            padding:12px;
            border-radius:8px;
            border:1px solid #ccc;
            font-size:15px;
            box-sizing:border-box;
            background:#fff;
        }

        .btns{
            display:flex;
            gap:10px;
            margin-top:20px;
        }

        .btn-pay{
            width:100%;
            background:#0b66ff;
            color:#fff;
            padding:14px;
            border:none;
            border-radius:26px;
            font-size:16px;
            font-weight:700;
            cursor:pointer;
        }

        .btn-pay:disabled{
            background:#999;
            cursor:not-allowed;
        }

        .rules{
            margin-top:22px;
            background:#fff;
            padding:14px;
            border-radius:10px;
            font-size:14px;
        }

        .rules h4{
            margin-top:0;
        }

        .rules p{
            margin:6px 0;
            color:#555;
        }

        @media(max-width:480px){
            .amount-btn{
                width:47%;
            }
        }
    </style>
</head>

<body>

<div class="header">
    â† <span>Recharger</span>
</div>

<div class="top-banner">
    <div class="balance-overlay">
        <h2>{{ "{:,.0f}".format(user.solde_total or 0) }} XOF</h2>
        <p>Solde du compte</p>
    </div>
</div>

<div class="container">

    <h3>Montant du dÃ©pÃ´t <small>(Minimum 3 000 FCFA)</small></h3>

    <div class="info-box">
        Paiement sÃ©curisÃ© via MoneyFusion
    </div>

    <div class="amount-grid">
        <div class="amount-btn" onclick="setAmount(3000)">3 000</div>
        <div class="amount-btn" onclick="setAmount(5000)">5 000</div>
        <div class="amount-btn" onclick="setAmount(10000)">10 000</div>
        <div class="amount-btn" onclick="setAmount(25000)">25 000</div>
        <div class="amount-btn" onclick="setAmount(50000)">50 000</div>
        <div class="amount-btn" onclick="setAmount(100000)">100 000</div>
    </div>

    <!-- Montant -->
    <div class="form-row">
        <input type="number" id="montant" placeholder="Entrer le montant" min="3000">
    </div>

    <!-- Pays -->
    <div class="form-row">
        <select id="country" required>
            <option value="">SÃ©lectionnez votre pays</option>
            <option value="Togo">ğŸ‡¹ğŸ‡¬ Togo</option>
            <option value="BÃ©nin">ğŸ‡§ğŸ‡¯ BÃ©nin</option>
            <option value="CÃ´te d'Ivoire">ğŸ‡¨ğŸ‡® CÃ´te d'Ivoire</option>
            <option value="Cameroun">ğŸ‡¨ğŸ‡² Cameroun</option>
            <option value="Mali">ğŸ‡²ğŸ‡± Mali</option>
            <option value="Gabon">ğŸ‡¬ğŸ‡¦ Gabon</option>
            <option value="SÃ©nÃ©gal">ğŸ‡¸ğŸ‡³ SÃ©nÃ©gal</option>
            <option value="Niger">ğŸ‡³ğŸ‡ª Niger</option>
            <option value="Burkina Faso">ğŸ‡§ğŸ‡« Burkina Faso</option>
            <option value="Congo Kinshasa">ğŸ‡¨ğŸ‡© Congo Kinshasa</option>
            <option value="Congo Brazzaville">ğŸ‡¨ğŸ‡¬ Congo Brazzaville</option>
        </select>
    </div>

    <!-- Moyen de paiement -->
    <div class="form-row">
        <select id="operator" required>
            <option value="">Moyen de paiement</option>
            <option value="Moov Money">Moov Money</option>
            <option value="TMoney">TMoney</option>
            <option value="Orange Money">Orange Money</option>
            <option value="MTN Money">MTN Money</option>
            <option value="Momo CI">Momo CI</option>
            <option value="Airtel Money">Airtel Money</option>
        </select>
    </div>

    <!-- NumÃ©ro -->
    <div class="form-row">
        <input type="tel" id="phone" placeholder="NumÃ©ro de paiement">
    </div>

    <!-- Nom -->
    <div class="form-row">
        <input type="text" id="fullname" placeholder="Nom sur le compte Mobile Money">
    </div>

    <div class="btns">
        <button class="btn-pay" onclick="payerEnLigne()">ProcÃ©der au paiement</button>
    </div>

    <div class="rules">
        <h4>Instructions</h4>
        <p>â€¢ Minimum de dÃ©pÃ´t : 3 000 FCFA</p>
        <p>â€¢ Remplissez le formulaire puis cliquez sur "ProcÃ©der au paiement"</p>
        <p>â€¢ Vous serez redirigÃ© vers la page de paiement</p>
        <p>â€¢ Validation sous 24h aprÃ¨s paiement</p>
    </div>

</div>

<script>
function setAmount(val){
    document.getElementById("montant").value = val;
}

function payerEnLigne(){
    const montant = document.getElementById("montant").value;
    const phone = document.getElementById("phone").value;
    const country = document.getElementById("country").value;
    const operator = document.getElementById("operator").value;
    const fullname = document.getElementById("fullname").value;
    const btn = document.querySelector(".btn-pay");

    if(!montant || montant < 3000){
        alert("Montant minimum : 3 000 FCFA");
        return;
    }
    if(!country || !operator || !phone || !fullname){
        alert("Veuillez remplir tous les champs");
        return;
    }

    btn.disabled = true;
    btn.innerText = "Redirection...";

    fetch("/deposit", {
        method: "POST",
        headers: {"Content-Type": "application/x-www-form-urlencoded"},
        body: `montant=${montant}&phone=${phone}&country=${country}&operator=${operator}&fullname=${fullname}`
    })
    .then(res => res.json())
    .then(data => {
        if(data.url){
            window.location.href = data.url;
        }else{
            alert("Erreur de paiement");
            btn.disabled = false;
            btn.innerText = "ProcÃ©der au paiement";
        }
    })
    .catch(() => {
        alert("Erreur rÃ©seau");
        btn.disabled = false;
        btn.innerText = "ProcÃ©der au paiement";
    });
}
</script>

</body>
</html>
